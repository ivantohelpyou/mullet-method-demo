#!/bin/bash
# Mullet Method Demo Helper Script
# Makes it even easier to run demo commands

set -e  # Exit on any error

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
PURPLE='\033[0;35m'
CYAN='\033[0;36m'
NC='\033[0m' # No Color

# Function to print colored output
print_header() {
    echo -e "${BLUE}üéØ $1${NC}"
}

print_success() {
    echo -e "${GREEN}‚úÖ $1${NC}"
}

print_warning() {
    echo -e "${YELLOW}‚ö†Ô∏è  $1${NC}"
}

print_error() {
    echo -e "${RED}‚ùå $1${NC}"
}

# Function to show usage
show_usage() {
    echo -e "${CYAN}üé≠ Mullet Method Demo Helper${NC}"
    echo
    echo "Usage: ./demo <command> [arguments]"
    echo
    echo "Commands:"
    echo "  ${GREEN}start${NC}           - Start the Flask application"
    echo "  ${GREEN}reset${NC}           - Reset database with sample data"
    echo "  ${GREEN}sites${NC}           - Show all sites in database"
    echo "  ${GREEN}restaurant${NC}      - Add pre-built restaurant site"
    echo "  ${GREEN}contact <site> <page>${NC} - Add contact form to page"
    echo "  ${GREEN}add <site> <page> <type> <title> <content>${NC} - Add content block"
    echo
    echo "Examples:"
    echo "  ./demo start"
    echo "  ./demo reset"
    echo "  ./demo sites"
    echo "  ./demo restaurant"
    echo "  ./demo contact corporate home"
    echo "  ./demo add blog home text \"Welcome\" \"Hello world\""
    echo
    echo "Content block types: text, html, list, quote, code, image, video, gallery"
}

# Check if we're in the right directory
if [ ! -f "app.py" ]; then
    print_error "Must be run from the mullet-method-demo-standalone directory"
    exit 1
fi

# Check if virtual environment exists
if [ ! -d ".venv" ]; then
    print_error "Virtual environment not found. Please set up .venv first."
    exit 1
fi

# Main command handling
case "${1:-}" in
    "start")
        print_header "Starting Mullet Method Demo Application"
        .venv/bin/python app.py
        ;;
    
    "reset")
        print_header "Resetting database with sample data"
        ./seed_data.py
        print_success "Database reset complete!"
        ;;
    
    "sites")
        print_header "Showing all sites in database"
        ./show_database_sites.py
        ;;
    
    "restaurant")
        print_header "Adding pre-built restaurant site"
        ./add_new_site.py
        print_success "Restaurant site added!"
        ;;
    
    "contact")
        if [ $# -ne 3 ]; then
            print_error "Usage: ./demo contact <site> <page>"
            echo "Example: ./demo contact corporate home"
            exit 1
        fi
        print_header "Adding contact form to $2/$3"
        ./add_contact_block.py "$2" "$3"
        ;;
    
    "add")
        if [ $# -ne 6 ]; then
            print_error "Usage: ./demo add <site> <page> <type> <title> <content>"
            echo "Example: ./demo add blog home text \"Welcome\" \"Hello world\""
            exit 1
        fi
        print_header "Adding $4 block to $2/$3"
        ./add_content_block.py "$2" "$3" "$4" "$5" "$6"
        ;;
    
    "help"|"-h"|"--help"|"")
        show_usage
        ;;
    
    *)
        print_error "Unknown command: $1"
        echo
        show_usage
        exit 1
        ;;
esac
